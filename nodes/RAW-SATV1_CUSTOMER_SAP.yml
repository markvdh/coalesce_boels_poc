steps:
  SATV1_CUSTOMER_SAP-33618bfd-e345-40c8-aaac-45924f893ccf:
    operation:
      config:
        postSQL: ""
        preSQL: ""
      database: ""
      dependencies: []
      deployEnabled: true
      description: ""
      isDataVault: false
      isMultisource: false
      locationID: ""
      locationName: RAW
      materializationType: view
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: e49f570f-a1b7-454f-9a9c-d151adfa34c8
              stepCounter: 33618bfd-e345-40c8-aaac-45924f893ccf
            config:
              is_hk: true
            dataType: STRING
            description: ""
            hashColumns: []
            hashDetails: null
            name: HK_CUSTOMER_H
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: c6aec886-6aec-4aa2-bfa2-3fad18d81d10
                    stepCounter: 01c68377-7062-4fd6-becb-4ab98c4e94a3
                transform: ""
          - columnReference:
              columnCounter: 1c2cd8a0-77cf-44a1-a63f-a1f972ee6a6e
              stepCounter: 33618bfd-e345-40c8-aaac-45924f893ccf
            dataType: STRING
            description: ""
            name: CLIENTID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f29914e2-6108-4971-8055-8d000f1ce76a
                    stepCounter: 01c68377-7062-4fd6-becb-4ab98c4e94a3
                transform: ""
          - columnReference:
              columnCounter: 203d246c-78cb-4af8-b5ec-b587a41d6239
              stepCounter: 33618bfd-e345-40c8-aaac-45924f893ccf
            dataType: STRING
            description: ""
            name: DEBTORNUMBER
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 6f88aebb-c3b5-455a-a72b-3b24af64f6b3
                    stepCounter: 01c68377-7062-4fd6-becb-4ab98c4e94a3
                transform: ""
          - columnReference:
              columnCounter: 17b217dd-fefc-4561-8fa7-c1d4b700bf8e
              stepCounter: 33618bfd-e345-40c8-aaac-45924f893ccf
            dataType: VARCHAR(256)
            description: ""
            hashColumns: []
            hashDetails: null
            name: LAND_1
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: e7fd25be-36b6-4dd6-b7e0-e6ac79ef42ec
                    stepCounter: 01c68377-7062-4fd6-becb-4ab98c4e94a3
                transform: ""
          - columnReference:
              columnCounter: 1078112c-db6f-4baf-b4cc-ab00a4339459
              stepCounter: 33618bfd-e345-40c8-aaac-45924f893ccf
            dataType: VARCHAR(256)
            description: ""
            hashColumns: []
            hashDetails: null
            name: NAME_1
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 768f1bfb-9081-484a-b2a0-8bd96aa03092
                    stepCounter: 01c68377-7062-4fd6-becb-4ab98c4e94a3
                transform: ""
          - columnReference:
              columnCounter: 20754f40-25e8-47a0-8b24-e5dcc582a7ee
              stepCounter: 33618bfd-e345-40c8-aaac-45924f893ccf
            dataType: VARCHAR(256)
            description: ""
            hashColumns: []
            hashDetails: null
            name: NAME_2
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 3b9c47a6-0aa7-4621-8ebd-8eaf59eefd97
                    stepCounter: 01c68377-7062-4fd6-becb-4ab98c4e94a3
                transform: ""
          - columnReference:
              columnCounter: f4d8745e-2757-48aa-a3c0-490d44bb80f6
              stepCounter: 33618bfd-e345-40c8-aaac-45924f893ccf
            dataType: VARCHAR(256)
            description: ""
            hashColumns: []
            hashDetails: null
            name: ORT_01
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 704940f7-bb5f-4e7f-af8b-98f00f9f623b
                    stepCounter: 01c68377-7062-4fd6-becb-4ab98c4e94a3
                transform: ""
          - columnReference:
              columnCounter: 079b4998-8f11-4b9b-be76-f42c0142a73a
              stepCounter: 33618bfd-e345-40c8-aaac-45924f893ccf
            dataType: VARCHAR(256)
            description: ""
            hashColumns: []
            hashDetails: null
            name: PSTLZ
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f3edf410-c2cc-4fef-bf9f-eec93f35acd7
                    stepCounter: 01c68377-7062-4fd6-becb-4ab98c4e94a3
                transform: ""
          - columnReference:
              columnCounter: 19afb5ae-d762-4699-98b1-dd6202de4397
              stepCounter: 33618bfd-e345-40c8-aaac-45924f893ccf
            dataType: VARCHAR(1024)
            description: ""
            hashColumns: []
            hashDetails: null
            name: STRAS
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ac37275a-beef-46bf-8367-0f196d03fbd2
                    stepCounter: 01c68377-7062-4fd6-becb-4ab98c4e94a3
                transform: ""
          - columnReference:
              columnCounter: ac889df7-741b-401a-9a51-6a545585babc
              stepCounter: 33618bfd-e345-40c8-aaac-45924f893ccf
            dataType: VARCHAR(256)
            description: ""
            hashColumns: []
            hashDetails: null
            name: KONZS
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: e0b3ab7d-48ff-4034-a9cf-def1172017e3
                    stepCounter: 01c68377-7062-4fd6-becb-4ab98c4e94a3
                transform: ""
          - columnReference:
              columnCounter: 5040263d-7966-480c-b3bc-bda3a45bf2fb
              stepCounter: 33618bfd-e345-40c8-aaac-45924f893ccf
            dataType: VARCHAR(256)
            description: ""
            hashColumns: []
            hashDetails: null
            name: SPRAS
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ba4433bb-444f-4505-84b9-6c186c4e6bbc
                    stepCounter: 01c68377-7062-4fd6-becb-4ab98c4e94a3
                transform: ""
          - columnReference:
              columnCounter: ab757406-6c82-4a12-96d8-c435a8cf3cc8
              stepCounter: 33618bfd-e345-40c8-aaac-45924f893ccf
            dataType: VARCHAR(256)
            description: ""
            hashColumns: []
            hashDetails: null
            name: BRAN_1
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 0649cd60-8ec4-4564-a2b8-640b07b0e122
                    stepCounter: 01c68377-7062-4fd6-becb-4ab98c4e94a3
                transform: ""
          - columnReference:
              columnCounter: 2912e46f-e8c0-4b03-9163-e9c3f08e48bf
              stepCounter: 33618bfd-e345-40c8-aaac-45924f893ccf
            dataType: STRING
            description: ""
            hashColumns: []
            hashDetails: null
            name: CHANGE_HASH
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: cd537c69-b79a-46b6-80b5-7d22ab624d3e
                    stepCounter: 01c68377-7062-4fd6-becb-4ab98c4e94a3
                transform: ""
          - columnReference:
              columnCounter: 5064ccb5-54e9-4012-94f7-3b8ca85a2cd4
              stepCounter: 33618bfd-e345-40c8-aaac-45924f893ccf
            dataType: STRING
            description: The Record Source (RSRC) describes the source of this data.
            hashColumns: []
            hashDetails: null
            name: RSRC
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: c0246400-6827-4a4b-ba11-5169781ccd9a
                    stepCounter: 01c68377-7062-4fd6-becb-4ab98c4e94a3
                transform: ""
          - columnReference:
              columnCounter: ad68d4d2-19c8-4fb5-89a6-763ebbeb9d63
              stepCounter: 33618bfd-e345-40c8-aaac-45924f893ccf
            dataType: TIMESTAMP
            description: The Load Date Timestamp (LDTS) describes when this data first arrived in the Data Warehouse.
            hashColumns: []
            hashDetails: null
            name: LDTS
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 7c378f4d-d063-4744-9723-20f14bfa67d8
                    stepCounter: 01c68377-7062-4fd6-becb-4ab98c4e94a3
                transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: a43c6765-4a61-4a5a-bea5-eb0d2db79f2c
              stepCounter: 33618bfd-e345-40c8-aaac-45924f893ccf
            config: {}
            dataType: TIMESTAMP
            defaultValue: ""
            description: ""
            hashColumns: []
            is_system_ledts: true
            name: LEDTS
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: |-
                  COALESCE(LEAD("{{ datavault4coalesce.config.ldts_alias }}" - INTERVAL '1 MICROSECOND') 
                  OVER (PARTITION BY "{{ get_value_by_column_attribute("is_hk") }}" 
                  ORDER BY "{{ datavault4coalesce.config.ldts_alias }}"), {{ datavault4coalesce__string_to_timestamp(datavault4coalesce.config.timestamp_format, datavault4coalesce.config.end_of_all_times) }})
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: d402fce1-6ed3-44e1-a387-364364e4fb16
              stepCounter: 33618bfd-e345-40c8-aaac-45924f893ccf
            config: {}
            dataType: BOOLEAN
            defaultValue: ""
            description: ""
            hashColumns: []
            is_system_current_col: true
            name: IS_CURRENT
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: |-
                  CASE 
                    WHEN 
                      LEAD("{{ datavault4coalesce.config.ldts_alias }}" - INTERVAL '1 MICROSECOND') 
                      OVER (PARTITION BY "{{ get_value_by_column_attribute("is_hk") }}" 
                      ORDER BY "{{ datavault4coalesce.config.ldts_alias }}") IS NULL 
                    THEN TRUE 
                    ELSE FALSE 
                  END
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - customSQL:
              customSQL: ""
            dependencies:
              - locationName: RAW
                nodeName: SATV0_CUSTOMER_SAP
            join:
              joinCondition: FROM {{ ref('RAW', 'SATV0_CUSTOMER_SAP') }} "SATV0_CUSTOMER_SAP"
            name: SATV1_CUSTOMER_SAP
            noLinkRefs: []
      name: SATV1_CUSTOMER_SAP
      overrideSQL: false
      schema: ""
      sqlType: SCALEFREE-DATAVAULT4COALESCE::9
      type: sql
    stepCounter: 33618bfd-e345-40c8-aaac-45924f893ccf
