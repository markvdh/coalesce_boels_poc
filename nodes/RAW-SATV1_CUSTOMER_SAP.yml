steps:
  SATV1_CUSTOMER_SAP-9e61541e-336b-4550-b6a5-f4c15f3faf25:
    operation:
      config:
        postSQL: ""
        preSQL: ""
      database: ""
      dependencies: []
      deployEnabled: true
      description: ""
      isDataVault: false
      isMultisource: false
      locationID: ""
      locationName: RAW
      materializationType: view
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: 87806839-3697-4c8b-99ae-8e65e6fdac87
              stepCounter: 9e61541e-336b-4550-b6a5-f4c15f3faf25
            config:
              is_hk: true
            dataType: STRING
            description: ""
            hashColumns: []
            hashDetails: null
            name: HK_CUSTOMER_H
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: c6aec886-6aec-4aa2-bfa2-3fad18d81d10
                    stepCounter: 01c68377-7062-4fd6-becb-4ab98c4e94a3
                transform: ""
          - columnReference:
              columnCounter: a5aef80a-d6bd-452d-a6f7-9e069bf8149b
              stepCounter: 9e61541e-336b-4550-b6a5-f4c15f3faf25
            dataType: STRING
            description: ""
            hashColumns: []
            hashDetails: null
            name: CLIENTID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 0c313e83-2f6d-4421-921a-b0d69670189a
                    stepCounter: 01c68377-7062-4fd6-becb-4ab98c4e94a3
                transform: ""
          - columnReference:
              columnCounter: 91f451ca-26de-4331-9c9b-d42135cbe5b0
              stepCounter: 9e61541e-336b-4550-b6a5-f4c15f3faf25
            dataType: STRING
            description: ""
            hashColumns: []
            hashDetails: null
            name: DEBTORNUMBER
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 55f0b165-be57-4a58-afa7-94996f7de8c9
                    stepCounter: 01c68377-7062-4fd6-becb-4ab98c4e94a3
                transform: ""
          - columnReference:
              columnCounter: bf795513-7a3e-4bb9-bb3d-d73054d0c55e
              stepCounter: 9e61541e-336b-4550-b6a5-f4c15f3faf25
            dataType: VARCHAR(256)
            description: ""
            hashColumns: []
            hashDetails: null
            name: LAND_1
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: e7fd25be-36b6-4dd6-b7e0-e6ac79ef42ec
                    stepCounter: 01c68377-7062-4fd6-becb-4ab98c4e94a3
                transform: ""
          - columnReference:
              columnCounter: ddf7f359-c5ab-4847-b2da-a8eb23167f9d
              stepCounter: 9e61541e-336b-4550-b6a5-f4c15f3faf25
            dataType: VARCHAR(256)
            description: ""
            hashColumns: []
            hashDetails: null
            name: NAME_1
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 768f1bfb-9081-484a-b2a0-8bd96aa03092
                    stepCounter: 01c68377-7062-4fd6-becb-4ab98c4e94a3
                transform: ""
          - columnReference:
              columnCounter: a9462cee-88f7-4ee9-8d45-0a6eaa6f2c83
              stepCounter: 9e61541e-336b-4550-b6a5-f4c15f3faf25
            dataType: VARCHAR(256)
            description: ""
            hashColumns: []
            hashDetails: null
            name: NAME_2
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 3b9c47a6-0aa7-4621-8ebd-8eaf59eefd97
                    stepCounter: 01c68377-7062-4fd6-becb-4ab98c4e94a3
                transform: ""
          - columnReference:
              columnCounter: 5721dbcf-5d81-40b5-bb57-0dc6ca754d7d
              stepCounter: 9e61541e-336b-4550-b6a5-f4c15f3faf25
            dataType: VARCHAR(256)
            description: ""
            hashColumns: []
            hashDetails: null
            name: ORT_01
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 704940f7-bb5f-4e7f-af8b-98f00f9f623b
                    stepCounter: 01c68377-7062-4fd6-becb-4ab98c4e94a3
                transform: ""
          - columnReference:
              columnCounter: 228c4890-3a04-4ebd-8375-cdf1f3ad8e3e
              stepCounter: 9e61541e-336b-4550-b6a5-f4c15f3faf25
            dataType: VARCHAR(256)
            description: ""
            hashColumns: []
            hashDetails: null
            name: PSTLZ
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f3edf410-c2cc-4fef-bf9f-eec93f35acd7
                    stepCounter: 01c68377-7062-4fd6-becb-4ab98c4e94a3
                transform: ""
          - columnReference:
              columnCounter: 459e57ed-13b6-4d26-a563-74fb325ce883
              stepCounter: 9e61541e-336b-4550-b6a5-f4c15f3faf25
            dataType: VARCHAR(1024)
            description: ""
            hashColumns: []
            hashDetails: null
            name: STRAS
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ac37275a-beef-46bf-8367-0f196d03fbd2
                    stepCounter: 01c68377-7062-4fd6-becb-4ab98c4e94a3
                transform: ""
          - columnReference:
              columnCounter: b73f92ec-7394-4536-91cc-09e68e104e5b
              stepCounter: 9e61541e-336b-4550-b6a5-f4c15f3faf25
            dataType: VARCHAR(256)
            description: ""
            hashColumns: []
            hashDetails: null
            name: KONZS
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: e0b3ab7d-48ff-4034-a9cf-def1172017e3
                    stepCounter: 01c68377-7062-4fd6-becb-4ab98c4e94a3
                transform: ""
          - columnReference:
              columnCounter: 572fbb7b-e85c-4e7e-bce4-623ee9a55dcc
              stepCounter: 9e61541e-336b-4550-b6a5-f4c15f3faf25
            dataType: VARCHAR(256)
            description: ""
            hashColumns: []
            hashDetails: null
            name: SPRAS
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ba4433bb-444f-4505-84b9-6c186c4e6bbc
                    stepCounter: 01c68377-7062-4fd6-becb-4ab98c4e94a3
                transform: ""
          - columnReference:
              columnCounter: a43bf1b6-d708-4a88-9194-2ae49dd2c5d4
              stepCounter: 9e61541e-336b-4550-b6a5-f4c15f3faf25
            dataType: VARCHAR(256)
            description: ""
            hashColumns: []
            hashDetails: null
            name: BRAN_1
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 0649cd60-8ec4-4564-a2b8-640b07b0e122
                    stepCounter: 01c68377-7062-4fd6-becb-4ab98c4e94a3
                transform: ""
          - columnReference:
              columnCounter: fddc3a81-8405-4c9e-9ee0-9289519159b4
              stepCounter: 9e61541e-336b-4550-b6a5-f4c15f3faf25
            dataType: STRING
            description: ""
            hashColumns: []
            hashDetails: null
            name: CHANGE_HASH
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: cd537c69-b79a-46b6-80b5-7d22ab624d3e
                    stepCounter: 01c68377-7062-4fd6-becb-4ab98c4e94a3
                transform: ""
          - columnReference:
              columnCounter: 348c3a57-5388-4fdd-abc3-17605507107b
              stepCounter: 9e61541e-336b-4550-b6a5-f4c15f3faf25
            dataType: TIMESTAMP
            description: The Load Date Timestamp (LDTS) describes when this data first arrived in the Data Warehouse.
            hashColumns: []
            hashDetails: null
            name: LDTS
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 7c378f4d-d063-4744-9723-20f14bfa67d8
                    stepCounter: 01c68377-7062-4fd6-becb-4ab98c4e94a3
                transform: ""
          - columnReference:
              columnCounter: e068d7cc-32d9-46f4-88ad-84ef40030b5b
              stepCounter: 9e61541e-336b-4550-b6a5-f4c15f3faf25
            dataType: STRING
            description: The Record Source (RSRC) describes the source of this data.
            hashColumns: []
            hashDetails: null
            name: RSRC
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: c0246400-6827-4a4b-ba11-5169781ccd9a
                    stepCounter: 01c68377-7062-4fd6-becb-4ab98c4e94a3
                transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 71544add-716c-42c1-a2c6-05910a9dbb5d
              stepCounter: 9e61541e-336b-4550-b6a5-f4c15f3faf25
            config: {}
            dataType: TIMESTAMP
            defaultValue: ""
            description: ""
            hashColumns: []
            is_system_ledts: true
            name: LEDTS
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: |-
                  COALESCE(LEAD("{{ datavault4coalesce.config.ldts_alias }}" - INTERVAL '1 MICROSECOND') 
                  OVER (PARTITION BY "{{ get_value_by_column_attribute("is_hk") }}" 
                  ORDER BY "{{ datavault4coalesce.config.ldts_alias }}"), {{ datavault4coalesce__string_to_timestamp(datavault4coalesce.config.timestamp_format, datavault4coalesce.config.end_of_all_times) }})
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 5168c03c-2058-4e13-82c8-f11b4294007c
              stepCounter: 9e61541e-336b-4550-b6a5-f4c15f3faf25
            config: {}
            dataType: BOOLEAN
            defaultValue: ""
            description: ""
            hashColumns: []
            is_system_current_col: true
            name: IS_CURRENT
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: |-
                  CASE 
                    WHEN 
                      LEAD("{{ datavault4coalesce.config.ldts_alias }}" - INTERVAL '1 MICROSECOND') 
                      OVER (PARTITION BY "{{ get_value_by_column_attribute("is_hk") }}" 
                      ORDER BY "{{ datavault4coalesce.config.ldts_alias }}") IS NULL 
                    THEN TRUE 
                    ELSE FALSE 
                  END
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - customSQL:
              customSQL: ""
            dependencies:
              - locationName: RAW
                nodeName: SATV0_CUSTOMER_SAP
            join:
              joinCondition: FROM {{ ref('RAW', 'SATV0_CUSTOMER_SAP') }} "SATV0_CUSTOMER_SAP"
            name: SATV1_CUSTOMER_SAP
            noLinkRefs: []
      name: SATV1_CUSTOMER_SAP
      overrideSQL: false
      schema: ""
      sqlType: SCALEFREE-DATAVAULT4COALESCE::9
      type: sql
    stepCounter: 9e61541e-336b-4550-b6a5-f4c15f3faf25
